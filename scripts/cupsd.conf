# cups daemon configuration - open admin & printing for everyone (unsecure! home network use ONLY)

LogLevel warn
PageLogFormat
MaxLogSize 0
ErrorPolicy retry-job

# Listen on the unix socket and all network interfaces on port 631
Listen /run/cups/cups.sock
Listen 0.0.0.0:631

# Enable printer browsing and mDNS (for AirPrint/Bonjour)
Browsing On
BrowseLocalProtocols dnssd
SharePrinters Yes

# Allow the web interface
WebInterface Yes

# Authentication/encryption: no encryption, no auth required (open)
DefaultAuthType Basic
DefaultEncryption Never

# Idle timeout
IdleExitTimeout 60

# Root - allow everything
<Location />
  Order allow,deny
  Allow all
</Location>

# Printers - allow everyone to see/use all printers
<Location /printers>
  Order allow,deny
  Allow all
</Location>

# Make specific printers accessible (optional, but harmless if present)
# If you have specific printers, you can keep entries or remove them - generic /printers covers them.
<Location /printers/LexmarkE330>
  Order allow,deny
  Allow all
</Location>

# Admin interface - allow everyone (gives full admin control to any client)
<Location /admin>
  Order allow,deny
  Allow all
</Location>

<Location /admin/conf>
  Order allow,deny
  Allow all
</Location>

<Location /admin/log>
  Order allow,deny
  Allow all
</Location>

# Policies - make default policy permissive for all operations
<Policy default>
  JobPrivateAccess default
  JobPrivateValues default
  SubscriptionPrivateAccess default
  SubscriptionPrivateValues default

  # Allow job creation and printing by anyone
  <Limit Create-Job Print-Job Print-URI Validate-Job>
    Order allow,deny
    Allow all
  </Limit>

  # Allow document and job management by anyone
  <Limit Send-Document Send-URI Hold-Job Release-Job Restart-Job Purge-Jobs
         Set-Job-Attributes Create-Job-Subscription Renew-Subscription Cancel-Subscription
         Get-Notifications Reprocess-Job Cancel-Current-Job Suspend-Current-Job Resume-Job
         Cancel-My-Jobs Close-Job CUPS-Move-Job CUPS-Get-Document>
    Order allow,deny
    Allow all
  </Limit>

  # Allow printer modification / add / delete / admin actions by anyone
  <Limit CUPS-Add-Modify-Printer CUPS-Delete-Printer CUPS-Add-Modify-Class
         CUPS-Delete-Class CUPS-Set-Default Pause-Printer Resume-Printer
         Enable-Printer Disable-Printer Pause-Printer-After-Current-Job Hold-New-Jobs
         Release-Held-New-Jobs Deactivate-Printer Activate-Printer Restart-Printer
         Shutdown-Printer Startup-Printer Promote-Job Schedule-Job-After Cancel-Jobs
         CUPS-Accept-Jobs CUPS-Reject-Jobs>
    Order allow,deny
    Allow all
  </Limit>

  # Cancel job and authentication-related actions allowed to all
  <Limit Cancel-Job CUPS-Authenticate-Job>
    Order allow,deny
    Allow all
  </Limit>

  # Catch-all: allow everything
  <Limit All>
    Order allow,deny
    Allow all
  </Limit>
</Policy>

# Make Kerberos policy permissive too (if present)
<Policy kerberos>
  JobPrivateAccess default
  JobPrivateValues default
  SubscriptionPrivateAccess default
  SubscriptionPrivateValues default

  <Limit Create-Job Print-Job Print-URI Validate-Job>
    AuthType None
    Order allow,deny
    Allow all
  </Limit>

  <Limit Send-Document Send-URI Hold-Job Release-Job Restart-Job Purge-Jobs
         Set-Job-Attributes Create-Job-Subscription Renew-Subscription Cancel-Subscription
         Get-Notifications Reprocess-Job Cancel-Current-Job Suspend-Current-Job Resume-Job
         Cancel-My-Jobs Close-Job CUPS-Move-Job CUPS-Get-Document>
    Order allow,deny
    Allow all
  </Limit>

  <Limit CUPS-Add-Modify-Printer CUPS-Delete-Printer CUPS-Add-Modify-Class
         CUPS-Delete-Class CUPS-Set-Default Pause-Printer Resume-Printer
         Enable-Printer Disable-Printer Pause-Printer-After-Current-Job Hold-New-Jobs
         Release-Held-New-Jobs Deactivate-Printer Activate-Printer Restart-Printer
         Shutdown-Printer Startup-Printer Promote-Job Schedule-Job-After Cancel-Jobs
         CUPS-Accept-Jobs CUPS-Reject-Jobs>
    Order allow,deny
    Allow all
  </Limit>

  <Limit Cancel-Job CUPS-Authenticate-Job>
    Order allow,deny
    Allow all
  </Limit>

  <Limit All>
    Order allow,deny
    Allow all
  </Limit>
</Policy>

# No default encryption required (open mode)
DefaultEncryption Never
